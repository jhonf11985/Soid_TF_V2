{% extends 'core/base.html' %}

{% block title %}Usuarios del sistema · Soid_Tf_2{% endblock %}

{% block breadcrumb %}
Configuración / Usuarios del sistema / Crear
{% endblock %}

{% block content %}

<section class="page-header">
    <div>
        <h1 class="page-title">Crear usuario del sistema</h1>
        <p class="page-subtitle">
            Registra una cuenta de acceso para líderes, secretaría u otros colaboradores
            y asígnales el rol adecuado dentro del sistema.
        </p>
    </div>
</section>

<section class="page-section">
    <div class="usuarios-layout">
        <!-- COLUMNA IZQUIERDA: FORMULARIO -->
        <div class="usuarios-card">
            <h2 class="usuarios-card-title">
                Datos de acceso
            </h2>
            <p class="usuarios-card-subtitle">
                Completa los datos básicos del usuario y asigna su rol dentro del sistema.
            </p>

            <form method="post" class="form-grid">
                {% csrf_token %}
                {{ form.non_field_errors }}

                <!-- Usuario + correo -->
                <div class="form-field">
                    <label for="{{ form.username.id_for_label }}">Nombre de usuario</label>
                    {{ form.username }}
                    {% if form.username.errors %}
                        <small class="form-error">{{ form.username.errors|striptags }}</small>
                    {% endif %}
                </div>

                <div class="form-field">
                    <label for="{{ form.email.id_for_label }}">Correo electrónico</label>
                    {{ form.email }}
                    {% if form.email.errors %}
                        <small class="form-error">{{ form.email.errors|striptags }}</small>
                    {% endif %}
                </div>

                <!-- Nombre + apellidos -->
                <div class="form-field">
                    <label for="{{ form.first_name.id_for_label }}">Nombre</label>
                    {{ form.first_name }}
                    {% if form.first_name.errors %}
                        <small class="form-error">{{ form.first_name.errors|striptags }}</small>
                    {% endif %}
                </div>

                <div class="form-field">
                    <label for="{{ form.last_name.id_for_label }}">Apellidos</label>
                    {{ form.last_name }}
                    {% if form.last_name.errors %}
                        <small class="form-error">{{ form.last_name.errors|striptags }}</small>
                    {% endif %}
                </div>

                <!-- Rol / grupo -->
                <div class="form-field form-field-full">
                    <label for="{{ form.grupo.id_for_label }}">Rol / Grupo</label>
                    {{ form.grupo }}
                    <p class="form-hint">
                        Ejemplos: <strong>Secretaría</strong>, <strong>Consulta miembros</strong>,
                        <strong>Administrador</strong>.
                    </p>
                    {% if form.grupo.errors %}
                        <small class="form-error">{{ form.grupo.errors|striptags }}</small>
                    {% endif %}
                </div>

                <!-- Contraseña -->
                <div class="form-field">
                    <label for="{{ form.password1.id_for_label }}">Contraseña</label>
                    {{ form.password1 }}
                    {% if form.password1.errors %}
                        <small class="form-error">{{ form.password1.errors|striptags }}</small>
                    {% endif %}
                </div>

                <div class="form-field">
                    <label for="{{ form.password2.id_for_label }}">Confirmar contraseña</label>
                    {{ form.password2 }}
                    {% if form.password2.errors %}
                        <small class="form-error">{{ form.password2.errors|striptags }}</small>
                    {% endif %}
                </div>

                <div class="form-actions" style="justify-content:flex-start; gap:8px; margin-top:8px;">
                    <button type="submit" class="btn-primary">
                        <span class="material-icons" style="font-size:16px;">person_add</span>
                        Crear usuario
                    </button>

                    <a href="{% url 'core:configuracion' %}" class="btn-secondary" style="text-decoration:none;">
                        <span class="material-icons" style="font-size:16px;">arrow_back</span>
                        Volver a configuración
                    </a>
                </div>
            </form>
        </div>

        <!-- COLUMNA DERECHA: INFO / AYUDA -->
        <aside class="usuarios-help-card">
            <h2 class="usuarios-help-title">
                Roles recomendados
            </h2>
            <p class="usuarios-help-text">
                Usa los grupos para controlar qué puede hacer cada persona
                dentro de Soid_Tf_2.
            </p>

            <ul class="usuarios-roles-list">
                <li>
                    <strong>Administrador</strong><br>
                    Acceso completo al sistema, configuración y todos los módulos.
                </li>
                <li>
                    <strong>Secretaría</strong><br>
                    Puede registrar y editar miembros y nuevos creyentes,
                    pero no eliminar ni cambiar configuraciones del sistema.
                </li>
                <li>
                    <strong>Consulta miembros</strong><br>
                    Solo puede ver listados e información, sin modificar datos.
                </li>
            </ul>

            <div class="usuarios-note">
                <span class="material-icons usuarios-note-icon">info</span>
                <p>
                    Solo los usuarios con rol de <strong>Administrador</strong> pueden crear
                    nuevos usuarios desde esta pantalla.
                </p>
            </div>
        </aside>
    </div>
</section>

<style>
    .usuarios-layout {
        display: grid;
        grid-template-columns: minmax(0, 2fr) minmax(0, 1.4fr);
        gap: 18px;
        align-items: flex-start;
    }

    @media (max-width: 900px) {
        .usuarios-layout {
            grid-template-columns: minmax(0, 1fr);
        }
    }

    .usuarios-card {
        background: #ffffff;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        padding: 16px 18px;
        box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
    }

    .usuarios-card-title {
        margin: 0 0 4px;
        font-size: 15px;
        font-weight: 600;
    }

    .usuarios-card-subtitle {
        margin: 0 0 14px;
        font-size: 12px;
        color: #6b7280;
    }

    .usuarios-help-card {
        background: #f9fafb;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        padding: 14px 16px;
    }

    .usuarios-help-title {
        margin: 0 0 6px;
        font-size: 14px;
        font-weight: 600;
    }

    .usuarios-help-text {
        margin: 0 0 10px;
        font-size: 12px;
        color: #6b7280;
    }

    .usuarios-roles-list {
        list-style: none;
        padding: 0;
        margin: 0 0 12px;
        font-size: 12px;
        color: #374151;
    }

    .usuarios-roles-list li {
        margin-bottom: 8px;
    }

    .usuarios-note {
        display: flex;
        align-items: flex-start;
        gap: 6px;
        padding: 8px 10px;
        border-radius: 8px;
        background: #eff6ff;
        border: 1px solid #bfdbfe;
        font-size: 11px;
        color: #1d4ed8;
    }

    .usuarios-note-icon {
        font-size: 16px;
        flex-shrink: 0;
    }

    .form-error {
        color: #b91c1c;
        font-size: 11px;
        margin-top: 2px;
        display: block;
    }
</style>

{% endblock %}
