{% extends 'core/base_sidebar.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/estructura.css' %}">
{% endblock %}

{% block sidebar_role_label %}Estructura{% endblock %}

{% block sidebar_menu %}
<nav class="sidebar-nav">

    <!-- Dashboard (solo si tiene permiso específico) -->
    {% if perms.estructura_app.ver_dashboard_estructura %}
    <a href="{% url 'estructura_app:dashboard' %}"
       class="sidebar-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
        <span class="material-icons">dashboard</span>
        <span>Dashboard</span>
    </a>
    {% endif %}

    <div class="sidebar-section-title">Gestión</div>

    <!-- Nueva unidad -->
    {% if perms.estructura_app.add_unidad %}
    <a href="{% url 'estructura_app:unidad_crear' %}"
       class="sidebar-link {% if request.resolver_match.url_name == 'unidad_crear' %}active{% endif %}">
        <span class="material-icons">account_tree</span>
        <span>Nueva unidad</span>
    </a>
    {% endif %}

    <!-- Unidades -->
    {% if perms.estructura_app.view_unidad %}
    <a href="{% url 'estructura_app:unidad_listado' %}"
       class="sidebar-link {% if request.resolver_match.url_name == 'unidad_listado' %}active{% endif %}">
        <span class="material-icons">list</span>
        <span>Unidades</span>
    </a>
    {% endif %}

    <!-- Asignar miembros -->
    {% if perms.estructura_app.change_unidadmembresia %}
    <a href="{% url 'estructura_app:asignacion_unidad' %}"
       class="sidebar-link {% if request.resolver_match.url_name == 'asignacion_unidad' %}active{% endif %}">
        <span class="material-icons">group_add</span>
        <span>Asignar miembros</span>
    </a>
    {% endif %}

    <!-- Roles -->
    {% if perms.estructura_app.view_rolunidad %}
    <a href="{% url 'estructura_app:rol_listado' %}"
       class="sidebar-link {% if request.resolver_match.url_name == 'rol_listado' %}active{% endif %}">
        <span class="material-icons">badge</span>
        <span>Roles</span>
    </a>
    {% endif %}

    <div class="sidebar-section-title">Reporte</div>

    <!-- Participación múltiple -->
    {% if perms.estructura_app.view_unidad %}
    <a href="{% url 'estructura_app:reporte_miembros_multi_unidad' %}"
       target="_blank" rel="noopener noreferrer"
       class="sidebar-link {% if request.resolver_match.url_name == 'reporte_miembros_multi_unidad' %}active{% endif %}">
        <span class="material-icons">analytics</span>
        <span>Participación múltiple</span>
    </a>
    {% endif %}

</nav>
{% endblock %}


{% block page_content %}
    {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {% block estructura_content %}{% endblock %}
{% endblock %}