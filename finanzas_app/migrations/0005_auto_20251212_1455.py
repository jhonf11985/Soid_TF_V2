# Generated by Django - fecha actual

from django.db import migrations


def crear_categorias_transferencia(apps, schema_editor):
    """
    Crea las categor√≠as especiales para transferencias.
    """
    CategoriaMovimiento = apps.get_model('finanzas_app', 'CategoriaMovimiento')
    
    # Categor√≠a para el lado del ENV√çO (egreso)
    CategoriaMovimiento.objects.get_or_create(
        nombre="Transferencia enviada",
        defaults={
            'tipo': 'egreso',
            'descripcion': 'Categor√≠a autom√°tica para transferencias entre cuentas (salida).',
            'activo': True,
            'es_editable': False,  # No debe poder borrarse
        }
    )
    
    # Categor√≠a para el lado de la RECEPCI√ìN (ingreso)
    CategoriaMovimiento.objects.get_or_create(
        nombre="Transferencia recibida",
        defaults={
            'tipo': 'ingreso',
            'descripcion': 'Categor√≠a autom√°tica para transferencias entre cuentas (entrada).',
            'activo': True,
            'es_editable': False,  # No debe poder borrarse
        }
    )


def eliminar_categorias_transferencia(apps, schema_editor):
    """
    Elimina las categor√≠as de transferencia (rollback).
    """
    CategoriaMovimiento = apps.get_model('finanzas_app', 'CategoriaMovimiento')
    
    CategoriaMovimiento.objects.filter(
        nombre__in=['Transferencia enviada', 'Transferencia recibida']
    ).delete()


class Migration(migrations.Migration):

    dependencies = [
        ('finanzas_app', '0004_movimientofinanciero_es_transferencia_and_more'),  # üëà Ajusta este n√∫mero seg√∫n tu migraci√≥n anterior
    ]

    operations = [
        migrations.RunPython(
            crear_categorias_transferencia,
            eliminar_categorias_transferencia
        ),
    ]