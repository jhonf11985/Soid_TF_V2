{% extends 'core/base_sidebar.html' %}
{% load static %}

{% block content %}
<style>
:root {
  --primary: #5c9ead;
  --primary-dark: #4a8a99;
  --primary-light: #e8f4f6;
  --primary-rgb: 92, 158, 173;
  --success: #22c55e;
  --success-light: #dcfce7;
  --warning: #f59e0b;
  --warning-light: #fef3c7;
  --danger: #ef4444;
  --danger-light: #fee2e2;
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-wrap{max-width:900px;margin:0 auto;padding:12px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER CARD - COMPACTO
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-header{
  background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);
  border-radius:16px;
  padding:16px;
  color:#fff;
  position:relative;
  overflow:hidden
}
.db-header::before{
  content:'';
  position:absolute;
  top:-80%;
  right:-20%;
  width:200px;
  height:200px;
  background:rgba(255,255,255,.08);
  border-radius:50%
}

.db-header-content{
  position:relative;
  z-index:1;
  display:flex;
  gap:14px;
  align-items:center
}

/* Avatar compacto */
.db-avatar-wrap{position:relative;flex-shrink:0}
.db-avatar{
  width:56px;
  height:56px;
  border-radius:50%;
  object-fit:cover;
  border:3px solid rgba(255,255,255,.3);
  background:rgba(255,255,255,.1)
}
.db-avatar-placeholder{
  width:56px;
  height:56px;
  border-radius:50%;
  border:3px solid rgba(255,255,255,.3);
  background:rgba(255,255,255,.15);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  font-weight:700;
  color:#fff
}
.db-status{
  position:absolute;
  bottom:0;
  right:0;
  width:18px;
  height:18px;
  border-radius:50%;
  background:var(--success);
  border:2px solid var(--primary);
  display:flex;
  align-items:center;
  justify-content:center
}
.db-status svg{width:10px;height:10px;color:#fff}

/* Info compacta */
.db-info{flex:1;min-width:0}
.db-name{font-size:17px;font-weight:800;margin:0;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.db-subtitle{font-size:12px;opacity:.85;margin-top:2px}
.db-badges-inline{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
.db-badge-sm{
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:3px 8px;
  border-radius:12px;
  font-size:10px;
  font-weight:600;
  background:rgba(255,255,255,.2);
  color:#fff
}

/* Botones en header */
.db-header-actions{
  display:flex;
  gap:8px;
  margin-top:12px
}
.db-btn-sm{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:8px 14px;
  border-radius:10px;
  font-size:12px;
  font-weight:700;
  text-decoration:none;
  border:none;
  cursor:pointer;
  flex:1
}
.db-btn-sm svg{width:14px;height:14px}
.db-btn-white{background:#fff;color:var(--primary-dark)}
.db-btn-ghost{background:rgba(255,255,255,.15);color:#fff}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUICK STATS - INLINE COMPACTO
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-stats-inline{
  display:flex;
  gap:8px;
  margin-top:12px;
  padding:10px;
  background:#fff;
  border-radius:12px;
  border:1px solid var(--gray-200)
}
.db-stat-mini{
  flex:1;
  text-align:center;
  padding:6px 4px;
  border-radius:8px;
  background:var(--gray-50)
}
.db-stat-mini-value{font-size:18px;font-weight:800;color:var(--primary);line-height:1}
.db-stat-mini-label{font-size:9px;color:var(--gray-500);text-transform:uppercase;letter-spacing:.3px;margin-top:2px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTIONS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-section{margin-top:16px}
.db-section-header{
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:10px;
  padding:0 2px
}
.db-section-icon{
  width:28px;
  height:28px;
  border-radius:8px;
  background:var(--primary);
  display:flex;
  align-items:center;
  justify-content:center;
  flex-shrink:0
}
.db-section-icon svg{width:14px;height:14px;color:#fff}
.db-section-title{font-size:14px;font-weight:700;color:var(--gray-800);margin:0}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACTIVITIES - COMPACTAS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-activities{display:flex;flex-direction:column;gap:8px}
.db-activity-card{
  display:flex;
  align-items:center;
  gap:10px;
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:10px;
  padding:10px 12px
}
.db-activity-date{
  width:42px;
  height:42px;
  border-radius:8px;
  background:var(--primary-light);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  flex-shrink:0
}
.db-activity-day{font-size:16px;font-weight:800;color:var(--primary);line-height:1}
.db-activity-month{font-size:9px;font-weight:600;color:var(--primary);text-transform:uppercase;margin-top:1px}
.db-activity-info{flex:1;min-width:0}
.db-activity-title{font-size:13px;font-weight:700;color:var(--gray-900);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.db-activity-meta{font-size:11px;color:var(--gray-500);margin-top:2px}
.db-activity-type{
  padding:4px 8px;
  border-radius:6px;
  font-size:9px;
  font-weight:700;
  text-transform:uppercase;
  flex-shrink:0
}
.db-type-culto{background:#dcfce7;color:#166534}
.db-type-reunion{background:#e0f2fe;color:#0369a1}
.db-type-evento{background:#fef3c7;color:#92400e}
.db-type-ensayo{background:#f3e8ff;color:#7c3aed}
.db-type-campana{background:#fee2e2;color:#dc2626}
.db-type-social{background:#fce7f3;color:#be185d}
.db-type-otro{background:var(--gray-100);color:var(--gray-600)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LÃDERES - LISTA COMPACTA
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-leaders-compact{
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:10px;
  overflow:hidden
}
.db-leader-row{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-bottom:1px solid var(--gray-100)
}
.db-leader-row:last-child{border-bottom:none}
.db-leader-avatar-sm{
  width:36px;
  height:36px;
  border-radius:50%;
  overflow:hidden;
  background:var(--gray-100);
  flex-shrink:0
}
.db-leader-avatar-sm img{width:100%;height:100%;object-fit:cover}
.db-leader-avatar-fb-sm{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  font-weight:700;
  color:#fff;
  background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%)
}
.db-leader-details{flex:1;min-width:0}
.db-leader-name-sm{font-size:13px;font-weight:600;color:var(--gray-900);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.db-leader-meta-sm{font-size:10px;color:var(--gray-500)}
.db-leader-actions{display:flex;gap:6px}
.db-action-btn{
  width:32px;
  height:32px;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  text-decoration:none;
  background:var(--gray-100);
  color:var(--gray-600);
  border:1px solid var(--gray-200)
}
.db-action-btn.whatsapp{background:#dcfce7;color:#166534;border-color:#bbf7d0}
.db-action-btn svg{width:14px;height:14px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRAMAS - CHIPS COMPACTOS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-programs-compact{
  display:flex;
  flex-wrap:wrap;
  gap:8px
}
.db-program-chip{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:8px 12px;
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:10px;
  font-size:12px;
  color:var(--gray-700)
}
.db-program-chip-icon{
  width:24px;
  height:24px;
  border-radius:6px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px
}
.db-program-chip-icon.maestro{background:#fef3c7}
.db-program-chip-icon.ayudante{background:#e0f2fe}
.db-program-chip-icon.alumno{background:var(--primary-light)}
.db-program-chip-name{font-weight:600;color:var(--gray-800)}
.db-program-chip-group{font-size:10px;color:var(--gray-500)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EMPTY STATE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-empty{
  padding:16px;
  text-align:center;
  color:var(--gray-500);
  font-size:12px;
  background:var(--gray-50);
  border-radius:10px;
  border:1px dashed var(--gray-300)
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE MÃ“VIL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:480px){
  .db-wrap{padding:8px}
  .db-header{padding:14px}
  .db-name{font-size:15px}
  .db-avatar,.db-avatar-placeholder{width:48px;height:48px}
  .db-avatar-placeholder{font-size:16px}
  .db-btn-sm{padding:7px 10px;font-size:11px}
  .db-stat-mini-value{font-size:16px}
  .db-activity-date{width:38px;height:38px}
  .db-activity-day{font-size:14px}
}
</style>

<div class="db-wrap">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HEADER COMPACTO
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-header">
    <div class="db-header-content">
      
      <div class="db-avatar-wrap">
        {% if miembro.foto %}
          <img class="db-avatar" src="{{ miembro.foto.url }}" alt="Foto">
        {% else %}
          <div class="db-avatar-placeholder">{{ miembro.nombres|slice:":1" }}{{ miembro.apellidos|slice:":1" }}</div>
        {% endif %}
        <div class="db-status">
          <svg fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24"><path d="M5 13l4 4L19 7"/></svg>
        </div>
      </div>

      <div class="db-info">
        <h1 class="db-name">{{ miembro.nombres }} {{ miembro.apellidos }}</h1>
        <p class="db-subtitle">{{ miembro.get_estado_miembro_display|default:"Miembro activo" }}</p>
        <div class="db-badges-inline">
          {% for u in unidades|slice:":2" %}
          <span class="db-badge-sm">{{ u.unidad_nombre|truncatechars:15 }}</span>
          {% endfor %}
          {% if unidades|length > 2 %}
          <span class="db-badge-sm">+{{ unidades|length|add:"-2" }}</span>
          {% endif %}
        </div>
      </div>

    </div>

    <div class="db-header-actions">
      <a class="db-btn-sm db-btn-white" href="{% url 'portal_miembros:perfil' %}">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
        Mi perfil
      </a>
      <a class="db-btn-sm db-btn-ghost" href="{% url 'portal_miembros:perfil_editar' %}">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
        Editar
      </a>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       STATS INLINE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-stats-inline">
    <div class="db-stat-mini">
      <div class="db-stat-mini-value">{{ unidades|length|default:"0" }}</div>
      <div class="db-stat-mini-label">Unidades</div>
    </div>
    <div class="db-stat-mini">
      <div class="db-stat-mini-value">{{ context_programas|length|default:"0" }}</div>
      <div class="db-stat-mini-label">Programas</div>
    </div>
    <div class="db-stat-mini">
      <div class="db-stat-mini-value">{% if miembro.bautizado_confirmado %}âœ“{% else %}â€”{% endif %}</div>
      <div class="db-stat-mini-label">Bautizado</div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PRÃ“XIMAS ACTIVIDADES
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-section">
    <div class="db-section-header">
      <div class="db-section-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
      </div>
      <h3 class="db-section-title">PrÃ³ximas actividades</h3>
    </div>

    {% if actividades %}
    <div class="db-activities">
      {% for act in actividades %}
      <div class="db-activity-card">
        <div class="db-activity-date">
          <span class="db-activity-day">{{ act.fecha|date:"d" }}</span>
          <span class="db-activity-month">{{ act.fecha|date:"M" }}</span>
        </div>
        <div class="db-activity-info">
          <div class="db-activity-title">{{ act.titulo }}</div>
          <div class="db-activity-meta">
            {% if act.hora_inicio %}{{ act.hora_inicio|time:"H:i" }}{% endif %}
            {% if act.lugar %} Â· {{ act.lugar }}{% endif %}
          </div>
        </div>
        <div class="db-activity-type db-type-{{ act.tipo|lower }}">
          {{ act.get_tipo_display }}
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="db-empty">No hay actividades programadas</div>
    {% endif %}
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MIS LÃDERES - COMPACTO
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  {% if unidades %}
  <div class="db-section">
    <div class="db-section-header">
      <div class="db-section-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/></svg>
      </div>
      <h3 class="db-section-title">Mis lÃ­deres</h3>
    </div>

    <div class="db-leaders-compact">
      {% for u in unidades %}
        {% for l in u.lideres %}
        <div class="db-leader-row">
          <div class="db-leader-avatar-sm">
            {% if l.foto_url %}
              <img src="{{ l.foto_url }}" alt="{{ l.nombre }}">
            {% else %}
              <div class="db-leader-avatar-fb-sm">{{ l.nombre|slice:":1" }}</div>
            {% endif %}
          </div>
          <div class="db-leader-details">
            <div class="db-leader-name-sm">{{ l.nombre }}</div>
            <div class="db-leader-meta-sm">{{ l.rol_nombre }} Â· {{ u.unidad_nombre }}</div>
          </div>
          <div class="db-leader-actions">
            {% if l.whatsapp %}
            <a class="db-action-btn whatsapp" href="https://wa.me/{{ l.whatsapp|cut:' '|cut:'-'|cut:'('|cut:')'|cut:'+' }}" target="_blank">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/></svg>
            </a>
            {% endif %}
            {% if l.telefono %}
            <a class="db-action-btn" href="tel:{{ l.telefono }}">
              <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>
            </a>
            {% endif %}
          </div>
        </div>
        {% empty %}
        {% endfor %}
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MIS PROGRAMAS - COMPACTO
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  {% if context_programas %}
  <div class="db-section">
    <div class="db-section-header">
      <div class="db-section-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
      </div>
      <h3 class="db-section-title">Mis programas</h3>
    </div>

    <div class="db-programs-compact">
      {% for p in context_programas %}
      <div class="db-program-chip">
        <div class="db-program-chip-icon {% if 'Maestro' in p.roles %}maestro{% elif 'Ayudante' in p.roles %}ayudante{% else %}alumno{% endif %}">
          {% if 'Maestro' in p.roles %}ğŸ‘¨â€ğŸ«{% elif 'Ayudante' in p.roles %}ğŸ¤{% else %}ğŸ“š{% endif %}
        </div>
        <div>
          <div class="db-program-chip-name">{{ p.programa_nombre|truncatechars:20 }}</div>
          <div class="db-program-chip-group">{{ p.grupo_nombre }}</div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

</div>
{% endblock %}