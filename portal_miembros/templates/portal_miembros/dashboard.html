{% extends 'core/base_sidebar.html' %}
{% load static %}

{% block content %}
<style>
:root {
  --primary: #5c9ead;
  --primary-dark: #4a8a99;
  --primary-light: #e8f4f6;
  --primary-rgb: 92, 158, 173;
  --success: #22c55e;
  --success-light: #dcfce7;
  --warning: #f59e0b;
  --warning-light: #fef3c7;
  --danger: #ef4444;
  --danger-light: #fee2e2;
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-wrap{max-width:900px;margin:0 auto;padding:12px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GREETING
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-greeting{
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:12px;
  padding:0 4px
}
.db-greeting-icon{font-size:24px}
.db-greeting-text{font-size:14px;color:var(--gray-600)}
.db-greeting-text strong{color:var(--gray-800)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER CARD
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-header{
  background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);
  border-radius:20px;
  padding:24px;
  color:#fff;
  position:relative;
  overflow:hidden
}
.db-header::before{
  content:'';
  position:absolute;
  top:-60%;
  right:-15%;
  width:300px;
  height:300px;
  background:rgba(255,255,255,.08);
  border-radius:50%
}
.db-header::after{
  content:'';
  position:absolute;
  bottom:-40%;
  left:-10%;
  width:200px;
  height:200px;
  background:rgba(255,255,255,.05);
  border-radius:50%
}

.db-header-content{
  position:relative;
  z-index:1;
  display:flex;
  gap:20px;
  align-items:center;
  flex-wrap:wrap
}

/* Avatar */
.db-avatar-wrap{position:relative;flex-shrink:0}
.db-avatar{
  width:90px;
  height:90px;
  border-radius:50%;
  object-fit:cover;
  border:4px solid rgba(255,255,255,.3);
  background:rgba(255,255,255,.1)
}
.db-avatar-placeholder{
  width:90px;
  height:90px;
  border-radius:50%;
  border:4px solid rgba(255,255,255,.3);
  background:rgba(255,255,255,.15);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
  font-weight:700;
  color:#fff
}
.db-status{
  position:absolute;
  bottom:4px;
  right:4px;
  width:22px;
  height:22px;
  border-radius:50%;
  background:var(--success);
  border:3px solid var(--primary);
  display:flex;
  align-items:center;
  justify-content:center
}
.db-status svg{width:12px;height:12px;color:#fff}

/* Info */
.db-info{flex:1;min-width:200px}
.db-name{font-size:22px;font-weight:800;margin:0;line-height:1.2}
.db-badges{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.db-badge{
  display:inline-flex;
  align-items:center;
  gap:5px;
  padding:5px 12px;
  border-radius:20px;
  font-size:12px;
  font-weight:600;
  background:rgba(255,255,255,.2);
  color:#fff
}
.db-badge svg{width:12px;height:12px}

.db-meta{display:flex;flex-wrap:wrap;gap:14px;margin-top:12px;font-size:13px;opacity:.9}
.db-meta-item{display:flex;align-items:center;gap:6px}
.db-meta-item svg{width:14px;height:14px;opacity:.8}

/* Actions */
.db-actions{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap}
.db-btn{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:12px 18px;
  border-radius:12px;
  font-size:14px;
  font-weight:700;
  text-decoration:none;
  border:none;
  cursor:pointer;
  transition:transform .1s,box-shadow .2s
}
.db-btn:active{transform:scale(.98)}
.db-btn svg{width:18px;height:18px}
.db-btn-white{background:#fff;color:var(--primary-dark)}
.db-btn-white:hover{box-shadow:0 4px 12px rgba(0,0,0,.15)}
.db-btn-ghost{background:rgba(255,255,255,.15);color:#fff}
.db-btn-ghost:hover{background:rgba(255,255,255,.25)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUICK STATS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-stats{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
  margin-top:16px
}
.db-stat{
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:14px;
  padding:16px;
  text-align:center;
  transition:transform .2s,box-shadow .2s
}
.db-stat:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.06)}
.db-stat-icon{
  width:44px;
  height:44px;
  border-radius:12px;
  background:var(--primary-light);
  display:flex;
  align-items:center;
  justify-content:center;
  margin:0 auto 10px
}
.db-stat-icon svg{width:22px;height:22px;color:var(--primary)}
.db-stat-value{font-size:20px;font-weight:800;color:var(--gray-900);margin:0}
.db-stat-label{font-size:11px;color:var(--gray-500);margin:4px 0 0;text-transform:uppercase;letter-spacing:.5px}

@media(max-width:600px){.db-stats{grid-template-columns:1fr 1fr 1fr}.db-stat{padding:12px}.db-stat-value{font-size:16px}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTIONS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-section{margin-top:20px}
.db-section-header{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:12px;
  padding:0 4px
}
.db-section-icon{
  width:36px;
  height:36px;
  border-radius:10px;
  background:var(--primary);
  display:flex;
  align-items:center;
  justify-content:center
}
.db-section-icon svg{width:18px;height:18px;color:#fff}
.db-section-info{flex:1}
.db-section-title{font-size:16px;font-weight:800;color:var(--gray-900);margin:0}
.db-section-subtitle{font-size:12px;color:var(--gray-500);margin:2px 0 0}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LEADERS GRID
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-leaders{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
@media(max-width:700px){.db-leaders{grid-template-columns:1fr}}

.db-leader-card{
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:14px;
  overflow:hidden
}
.db-leader-head{
  padding:12px 14px;
  background:var(--primary-light);
  border-bottom:1px solid #d5e8ec;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px
}
.db-leader-unit{font-size:14px;font-weight:800;color:var(--gray-900)}
.db-leader-chip{
  font-size:10px;
  font-weight:700;
  padding:4px 10px;
  border-radius:20px;
  background:var(--primary);
  color:#fff
}
.db-leader-body{padding:12px 14px}
.db-leader-item{
  display:flex;
  gap:12px;
  padding:10px 0;
  border-bottom:1px dashed var(--gray-200)
}
.db-leader-item:last-child{border-bottom:none}
.db-leader-avatar{
  width:44px;
  height:44px;
  border-radius:50%;
  overflow:hidden;
  background:var(--gray-100);
  flex-shrink:0
}
.db-leader-avatar img{width:100%;height:100%;object-fit:cover}
.db-leader-avatar-fb{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  color:#fff;
  background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%)
}
.db-leader-info{flex:1;min-width:0}
.db-leader-name{font-size:13px;font-weight:700;color:var(--gray-900)}
.db-leader-role{font-size:12px;color:var(--gray-500);margin-top:2px}
.db-leader-contacts{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.db-contact-btn{
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:6px 10px;
  border-radius:8px;
  font-size:11px;
  font-weight:600;
  text-decoration:none;
  background:var(--gray-100);
  color:var(--gray-700);
  border:1px solid var(--gray-200);
  transition:all .2s
}
.db-contact-btn:hover{background:var(--gray-200)}
.db-contact-btn.whatsapp{background:#dcfce7;color:#166534;border-color:#bbf7d0}
.db-contact-btn.whatsapp:hover{background:#bbf7d0}

.db-empty{
  padding:20px;
  text-align:center;
  color:var(--gray-500);
  font-size:13px;
  background:var(--gray-50);
  border-radius:12px;
  border:1px dashed var(--gray-300)
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRAMS GRID
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-programs{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
@media(max-width:700px){.db-programs{grid-template-columns:1fr}}

.db-program-card{
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:14px;
  overflow:hidden
}
.db-program-head{
  padding:12px 14px;
  background:linear-gradient(135deg,var(--gray-50) 0%,#fff 100%);
  border-bottom:1px solid var(--gray-200)
}
.db-program-title{font-size:14px;font-weight:800;color:var(--gray-900)}
.db-program-cycle{font-size:12px;color:var(--gray-500);margin-left:6px}
.db-program-group{font-size:13px;color:var(--gray-600);margin-top:4px;font-weight:600}
.db-program-body{padding:12px 14px}
.db-program-roles{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px}
.db-role-badge{
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:4px 10px;
  border-radius:20px;
  font-size:11px;
  font-weight:600
}
.db-role-maestro{background:#fef3c7;color:#92400e}
.db-role-ayudante{background:#e0f2fe;color:#0369a1}
.db-role-alumno{background:var(--primary-light);color:var(--primary-dark)}
.db-program-meta{display:flex;flex-direction:column;gap:6px;font-size:12px;color:var(--gray-600)}
.db-program-meta-item{display:flex;align-items:flex-start;gap:6px}
.db-program-meta-item strong{color:var(--gray-700)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACTIVITIES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.db-activities{display:flex;flex-direction:column;gap:10px}
.db-activity-card{
  display:flex;
  align-items:center;
  gap:14px;
  background:#fff;
  border:1px solid var(--gray-200);
  border-radius:12px;
  padding:14px;
  transition:transform .2s,box-shadow .2s
}
.db-activity-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.06)}
.db-activity-date{
  width:50px;
  height:50px;
  border-radius:10px;
  background:var(--primary-light);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  flex-shrink:0
}
.db-activity-day{font-size:18px;font-weight:800;color:var(--primary);line-height:1}
.db-activity-month{font-size:10px;font-weight:600;color:var(--primary);text-transform:uppercase;margin-top:2px}
.db-activity-info{flex:1;min-width:0}
.db-activity-title{font-size:14px;font-weight:700;color:var(--gray-900)}
.db-activity-meta{display:flex;flex-wrap:wrap;gap:10px;margin-top:4px;font-size:12px;color:var(--gray-500)}
.db-activity-meta-item{display:flex;align-items:center;gap:4px}
.db-activity-badge{
  display:inline-block;
  margin-top:6px;
  padding:3px 8px;
  border-radius:6px;
  font-size:10px;
  font-weight:600;
  background:var(--gray-100);
  color:var(--gray-600)
}
.db-activity-type{
  padding:5px 10px;
  border-radius:8px;
  font-size:11px;
  font-weight:700;
  text-transform:uppercase;
  flex-shrink:0
}
.db-type-culto{background:#dcfce7;color:#166534}
.db-type-reunion{background:#e0f2fe;color:#0369a1}
.db-type-evento{background:#fef3c7;color:#92400e}
.db-type-ensayo{background:#f3e8ff;color:#7c3aed}
.db-type-campana{background:#fee2e2;color:#dc2626}
.db-type-social{background:#fce7f3;color:#be185d}
.db-type-otro{background:var(--gray-100);color:var(--gray-600)}

@media(max-width:500px){
  .db-activity-card{flex-wrap:wrap}
  .db-activity-type{width:100%;text-align:center;margin-top:8px}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:540px){
  .db-wrap{padding:8px}
  .db-header{padding:20px 16px;border-radius:16px}
  .db-header-content{flex-direction:column;text-align:center}
  .db-avatar,.db-avatar-placeholder{width:80px;height:80px}
  .db-avatar-placeholder{font-size:24px}
  .db-name{font-size:18px}
  .db-badges{justify-content:center}
  .db-meta{justify-content:center}
  .db-actions{justify-content:center;width:100%}
  .db-btn{flex:1;justify-content:center}
}
</style>

<div class="db-wrap">

  <!-- Greeting -->
  <div class="db-greeting">
    <span class="db-greeting-icon">ğŸ‘‹</span>
    <span class="db-greeting-text">Â¡Hola, <strong>{{ miembro.nombres }}</strong>! Bienvenido a tu portal.</span>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HEADER CARD
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-header">
    <div class="db-header-content">
      
      <div class="db-avatar-wrap">
        {% if miembro.foto %}
          <img class="db-avatar" src="{{ miembro.foto.url }}" alt="Foto">
        {% else %}
          <div class="db-avatar-placeholder">{{ miembro.nombres|slice:":1" }}{{ miembro.apellidos|slice:":1" }}</div>
        {% endif %}
        <div class="db-status">
          <svg fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24"><path d="M5 13l4 4L19 7"/></svg>
        </div>
      </div>

      <div class="db-info">
        <h1 class="db-name">{{ miembro.nombres }} {{ miembro.apellidos }}</h1>
        
        <div class="db-badges">
          <span class="db-badge">
            <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            {{ miembro.get_estado_miembro_display|default:"Activo" }}
          </span>
          {% for u in unidades %}
            <span class="db-badge">
              <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
              {{ u.unidad_nombre }}{% if u.tiene_liderazgo %} â€¢ LÃ­der{% endif %}
            </span>
          {% endfor %}
        </div>

        <div class="db-meta">
          {% if miembro.fecha_ingreso_iglesia %}
          <span class="db-meta-item">
            <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
            Desde {{ miembro.fecha_ingreso_iglesia|date:"M Y" }}
          </span>
          {% endif %}
          {% if miembro.codigo_miembro %}
          <span class="db-meta-item">
            <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0"/></svg>
            {{ miembro.codigo_miembro }}
          </span>
          {% endif %}
          {% if lider_nombre %}
          <span class="db-meta-item">
            <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
            LÃ­der: {{ lider_nombre }}
          </span>
          {% endif %}
        </div>

        <div class="db-actions">
          <a class="db-btn db-btn-white" href="{% url 'portal_miembros:perfil' %}">
            <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
            Ver mi perfil
          </a>
          <a class="db-btn db-btn-ghost" href="{% url 'portal_miembros:perfil_editar' %}">
            <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
            Editar datos
          </a>
        </div>
      </div>

    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       QUICK STATS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-stats">
    <div class="db-stat">
      <div class="db-stat-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
      </div>
      <p class="db-stat-value">{{ unidades|length|default:"0" }}</p>
      <p class="db-stat-label">Unidades</p>
    </div>
    <div class="db-stat">
      <div class="db-stat-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
      </div>
      <p class="db-stat-value">{{ context_programas|length|default:"0" }}</p>
      <p class="db-stat-label">Programas</p>
    </div>
    <div class="db-stat">
      <div class="db-stat-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>
      </div>
      <p class="db-stat-value">{% if miembro.bautizado_confirmado %}SÃ­{% else %}No{% endif %}</p>
      <p class="db-stat-label">Bautizado</p>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MIS LÃDERES
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-section">
    <div class="db-section-header">
      <div class="db-section-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/></svg>
      </div>
      <div class="db-section-info">
        <h3 class="db-section-title">Mis lÃ­deres</h3>
        <p class="db-section-subtitle">Contactos de liderazgo en cada unidad</p>
      </div>
    </div>

    {% if unidades %}
    <div class="db-leaders">
      {% for u in unidades %}
      <div class="db-leader-card">
        <div class="db-leader-head">
          <span class="db-leader-unit">{{ u.unidad_nombre }}</span>
          {% if u.tiene_liderazgo %}
          <span class="db-leader-chip">Eres lÃ­der</span>
          {% endif %}
        </div>
        <div class="db-leader-body">
          {% if u.lideres %}
            {% for l in u.lideres %}
            <div class="db-leader-item">
              <div class="db-leader-avatar">
                {% if l.foto_url %}
                  <img src="{{ l.foto_url }}" alt="{{ l.nombre }}">
                {% else %}
                  <div class="db-leader-avatar-fb">{{ l.nombre|slice:":1" }}</div>
                {% endif %}
              </div>
              <div class="db-leader-info">
                <div class="db-leader-name">{{ l.nombre }}</div>
                <div class="db-leader-role">{{ l.rol_nombre }}</div>
                <div class="db-leader-contacts">
                  {% if l.whatsapp %}
                  <a class="db-contact-btn whatsapp" href="https://wa.me/{{ l.whatsapp|cut:' '|cut:'-'|cut:'('|cut:')'|cut:'+' }}" target="_blank">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/></svg>
                    WhatsApp
                  </a>
                  {% endif %}
                  {% if l.telefono %}
                  <a class="db-contact-btn" href="tel:{{ l.telefono }}">ğŸ“ Llamar</a>
                  {% endif %}
                  {% if l.email %}
                  <a class="db-contact-btn" href="mailto:{{ l.email }}">âœ‰ï¸ Email</a>
                  {% endif %}
                </div>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <div class="db-empty" style="padding:14px">Sin lÃ­deres asignados</div>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="db-empty">No estÃ¡s asignado a ninguna unidad todavÃ­a.</div>
    {% endif %}
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MIS PROGRAMAS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-section">
    <div class="db-section-header">
      <div class="db-section-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
      </div>
      <div class="db-section-info">
        <h3 class="db-section-title">Mis programas</h3>
        <p class="db-section-subtitle">Grupos donde participas o sirves</p>
      </div>
    </div>

    {% if context_programas %}
    <div class="db-programs">
      {% for p in context_programas %}
      <div class="db-program-card">
        <div class="db-program-head">
          <div class="db-program-title">
            {{ p.programa_nombre }}
            {% if p.ciclo_nombre %}<span class="db-program-cycle">â€¢ {{ p.ciclo_nombre }}</span>{% endif %}
          </div>
          <div class="db-program-group">{{ p.grupo_nombre }}</div>
        </div>
        <div class="db-program-body">
          <div class="db-program-roles">
            {% for r in p.roles %}
            <span class="db-role-badge {% if r == 'Maestro' %}db-role-maestro{% elif r == 'Ayudante' %}db-role-ayudante{% else %}db-role-alumno{% endif %}">
              {% if r == 'Maestro' %}ğŸ‘¨â€ğŸ«{% elif r == 'Ayudante' %}ğŸ¤{% else %}ğŸ“š{% endif %} {{ r }}
            </span>
            {% endfor %}
          </div>
          {% if p.horario or p.lugar or p.maestros or p.ayudantes %}
          <div class="db-program-meta">
            {% if p.horario %}<div class="db-program-meta-item">ğŸ•’ {{ p.horario }}</div>{% endif %}
            {% if p.lugar %}<div class="db-program-meta-item">ğŸ“ {{ p.lugar }}</div>{% endif %}
            {% if p.maestros %}<div class="db-program-meta-item">ğŸ‘¨â€ğŸ« <strong>{{ p.maestros|join:", " }}</strong></div>{% endif %}
            {% if p.ayudantes %}<div class="db-program-meta-item">ğŸ¤ <strong>{{ p.ayudantes|join:", " }}</strong></div>{% endif %}
          </div>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="db-empty">No estÃ¡s asignado a ningÃºn programa todavÃ­a.</div>
    {% endif %}
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PRÃ“XIMAS ACTIVIDADES
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="db-section">
    <div class="db-section-header">
      <div class="db-section-icon">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
      </div>
      <div class="db-section-info">
        <h3 class="db-section-title">PrÃ³ximas actividades</h3>
        <p class="db-section-subtitle">Eventos y actividades de la iglesia</p>
      </div>
    </div>

    {% if actividades %}
    <div class="db-activities">
      {% for act in actividades %}
      <div class="db-activity-card">
        <div class="db-activity-date">
          <span class="db-activity-day">{{ act.fecha|date:"d" }}</span>
          <span class="db-activity-month">{{ act.fecha|date:"M" }}</span>
        </div>
        <div class="db-activity-info">
          <div class="db-activity-title">{{ act.titulo }}</div>
          <div class="db-activity-meta">
            {% if act.hora_inicio %}
            <span class="db-activity-meta-item">ğŸ•’ {{ act.hora_inicio|time:"H:i" }}{% if act.hora_fin %} - {{ act.hora_fin|time:"H:i" }}{% endif %}</span>
            {% endif %}
            {% if act.lugar %}
            <span class="db-activity-meta-item">ğŸ“ {{ act.lugar }}</span>
            {% endif %}
          </div>
          {% if act.unidad %}
          <span class="db-activity-badge">{{ act.unidad.nombre }}</span>
          {% endif %}
        </div>
        <div class="db-activity-type db-type-{{ act.tipo|lower }}">
          {{ act.get_tipo_display }}
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="db-empty">No hay actividades programadas prÃ³ximamente.</div>
    {% endif %}
  </div>

</div>
{% endblock %}