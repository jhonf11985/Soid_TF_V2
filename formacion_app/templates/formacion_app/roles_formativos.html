{% extends "formacion_app/base_formacion.html" %}

{% block title %}Maestros y Ayudantes · Formación{% endblock %}

{% block formacion_content %}

<style>
  .odoo-page { background:#fff; border:1px solid #e9ecef; border-radius:8px; overflow:hidden; }
  .odoo-topbar { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 16px; background:#f8f9fa; border-bottom:1px solid #dee2e6; flex-wrap:wrap; }
  .odoo-title { display:flex; align-items:center; gap:8px; font-size:16px; font-weight:700; color:#212529; }
  .odoo-title .material-icons { color:#714B67; }
  .odoo-actions { display:flex; gap:8px; }
  .btn { display:inline-flex; align-items:center; gap:6px; padding:8px 12px; border-radius:6px; border:none; cursor:pointer; font-size:13px; font-weight:600; }
  .btn-primary { background:#714B67; color:#fff; }
  .btn-secondary { background:#e9ecef; color:#495057; text-decoration:none; }
  .btn-sm { padding:6px 10px; font-size:12px; }

  .tabs { display:flex; gap:0; border-bottom:2px solid #dee2e6; background:#f8f9fa; padding:0 16px; }
  .tab { border:none; background:transparent; padding:12px 16px; cursor:pointer; font-weight:600; color:#6c757d; border-bottom:3px solid transparent; }
  .tab.active { color:#714B67; border-bottom-color:#714B67; background:#fff; }

  .panel { padding:16px; display:none; }
  .panel.active { display:block; }

  table { width:100%; border-collapse:collapse; }
  th, td { padding:10px 12px; border-bottom:1px solid #f1f3f4; font-size:13px; text-align:left; }
  th { color:#6c757d; font-weight:700; background:#fff; }
  tr:hover td { background:#fafafa; }

  .status { padding:3px 10px; border-radius:999px; font-size:12px; font-weight:700; display:inline-flex; align-items:center; gap:4px; }
  .status.on { background:#d1fae5; color:#065f46; }
  .status.off { background:#fee2e2; color:#991b1b; }

  .empty { padding:16px; color:#6c757d; display:flex; gap:6px; align-items:center; }
</style>

<div class="odoo-page">

  <!-- TOP BAR -->
  <div class="odoo-topbar">
    <div class="odoo-title">
      <span class="material-icons">manage_accounts</span>
      Maestros y Ayudantes
    </div>
    <div class="odoo-actions">
      <a href="{% url 'formacion:rol_formativo_nuevo' %}" class="btn btn-primary">
        <span class="material-icons">add</span>
        Añadir
      </a>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab active" data-tab="maestros">Maestros</button>
    <button class="tab" data-tab="ayudantes">Ayudantes</button>
  </div>

  <!-- PANEL MAESTROS -->
  <div class="panel active" id="panel-maestros">
    <table>
      <thead>
        <tr>
          <th>Miembro</th>
          <th>Código</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for r in maestros %}
        <tr>
          <td>{{ r.miembro.nombres }} {{ r.miembro.apellidos }}</td>
          <td>{{ r.miembro.codigo_miembro|default:"—" }}</td>
          <td>
            {% if r.activo %}
              <span class="status on">Activo</span>
            {% else %}
              <span class="status off">Inactivo</span>
            {% endif %}
          </td>
          <td>
            <form method="post" action="{% url 'formacion:rol_formativo_toggle' r.id %}">
              {% csrf_token %}
              {% if r.activo %}
                <button class="btn btn-secondary btn-sm" type="submit">
                  <span class="material-icons" style="font-size:16px;">block</span>
                  Desactivar
                </button>
              {% else %}
                <button class="btn btn-secondary btn-sm" type="submit">
                  <span class="material-icons" style="font-size:16px;">check_circle</span>
                  Activar
                </button>
              {% endif %}
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4">
            <div class="empty">
              <span class="material-icons">info</span>
              No hay maestros registrados.
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- PANEL AYUDANTES -->
  <div class="panel" id="panel-ayudantes">
    <table>
      <thead>
        <tr>
          <th>Miembro</th>
          <th>Código</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for r in ayudantes %}
        <tr>
          <td>{{ r.miembro.nombres }} {{ r.miembro.apellidos }}</td>
          <td>{{ r.miembro.codigo_miembro|default:"—" }}</td>
          <td>
            {% if r.activo %}
              <span class="status on">Activo</span>
            {% else %}
              <span class="status off">Inactivo</span>
            {% endif %}
          </td>
          <td>
            <form method="post" action="{% url 'formacion:rol_formativo_toggle' r.id %}">
              {% csrf_token %}
              {% if r.activo %}
                <button class="btn btn-secondary btn-sm" type="submit">
                  <span class="material-icons" style="font-size:16px;">block</span>
                  Desactivar
                </button>
              {% else %}
                <button class="btn btn-secondary btn-sm" type="submit">
                  <span class="material-icons" style="font-size:16px;">check_circle</span>
                  Activar
                </button>
              {% endif %}
            </form>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4">
            <div class="empty">
              <span class="material-icons">info</span>
              No hay ayudantes registrados.
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const tabs = document.querySelectorAll(".tab");
    const panels = {
      maestros: document.getElementById("panel-maestros"),
      ayudantes: document.getElementById("panel-ayudantes"),
    };

    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        tabs.forEach(t => t.classList.remove("active"));
        Object.values(panels).forEach(p => p.classList.remove("active"));

        tab.classList.add("active");
        panels[tab.dataset.tab].classList.add("active");
      });
    });
  });
</script>

{% endblock %}
