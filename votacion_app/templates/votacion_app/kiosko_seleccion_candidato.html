@login_required
def kiosko_seleccion_candidato(request):
    votacion, ronda = obtener_votacion_y_ronda_activas()
    miembro_id = request.session.get("kiosko_miembro_id")

    if not votacion or not ronda or not miembro_id:
        return redirect("votacion:kiosko_ingreso_codigo")

    candidatos = votacion.candidatos.filter(activo=True)

    if request.method == "POST":
        candidato_id = request.POST.get("candidato_id")
        request.session["kiosko_candidato_id"] = candidato_id
        return redirect("votacion:kiosko_confirmacion")

    return render(request, "votacion_app/kiosko_seleccion_candidato.html", {
        "candidatos": candidatos
    })
